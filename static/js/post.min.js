document.addEventListener("DOMContentLoaded",function(){fetchPostData(),document.getElementById("like-button").addEventListener("click",function(){isAuthenticated?fetch(`/posts/${postID}/like-toggle`,{method:"POST",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{document.getElementById("like-count").textContent=e.likes,document.getElementById("like-toggle").textContent=e.liked?"Unlike":"Like"}):(window.location.href="/signin",console.log("user not logged in"))}),document.getElementById("comment-form").addEventListener("submit",function(e){if(isAuthenticated){e.preventDefault();let t=document.getElementById("comment-content").value;fetch(`/posts/${postID}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t})}).then(e=>e.json()).then(e=>{document.getElementById("comments").innerHTML+=`
    <div class="comment d-flex align-items-center">
        <span class="mb-0"><strong>${e.user_name}</strong>: ${e.content}</span>
        <button class="btn btn-link text-danger ms-2 p-0 delete-comment" data-comment-id="${e.id}">
            <i class="fas fa-trash-alt"></i>
        </button>
    </div>
`,document.getElementById("comment-form").reset()})}else window.location.href="/signin",console.log("user not logged in")}),document.addEventListener("click",function(e){let t=e.target.closest(".delete-comment");if(t){let n=t.dataset.commentId;if(!n||!confirm("Are you sure you want to delete this comment?"))return;fetch(`/comments/${n}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok)return e.json();t.closest(".comment").remove()}).catch(e=>console.error("Error deleting comment:",e))}})});function fetchPostData(){fetch(`/posts/${postID}`).then(e=>e.json()).then(e=>{document.getElementById("like-count").textContent=e.likes;let t=document.getElementById("comments");t.innerHTML="",e.comments.forEach(e=>{t.innerHTML+=`
    <div class="comment d-flex align-items-center">
        <span class="mb-0"><strong>${e.author}</strong>: ${e.content}</span>
        {{ if eq $.AuthUserID .UserID }}
            <button class="btn btn-link text-danger ms-2 p-0 delete-comment" data-comment-id="{{ .ID }}">
                <i class="fas fa-trash-alt"></i>
            </button>
        {{ end }}
    </div>
`})})}